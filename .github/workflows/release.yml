# DO NOT EDIT! Generated by eval-github-yaml from .github/workflows/release.ncl
{
  "jobs": {
    "tarball": {
      "runs-on": "ubuntu-latest",
      "steps": [
        {
          "uses": "actions/checkout@v3"
        },
        {
          "name": "Installing Nix",
          "uses": "cachix/install-nix-action@v20",
          "with": {
            "extra_nix_config": "experimental-features = nix-command flakes",
            "nix_path": "nixpkgs=channel:nixos-unstable"
          }
        },
        {
          "name": "Setup Cachix",
          "uses": "cachix/cachix-action@v12",
          "with": {
            "authToken": "${{ secrets.CACHIX_TWEAG_NICKEL_AUTH_TOKEN }}",
            "name": "tweag-nickel"
          }
        },
        {
          "name": "Create Release Tarball",
          "run": "nix build .#release --print-build-logs"
        },
        {
          "name": "Upload Release Tarball",
          "uses": "actions/upload-release-asset@v1",
          "with": {
            "asset_content_type": "application/x-xz",
            "asset_name": "Generated Tf-Ncl Schemas",
            "asset_path": "./result/tf-ncl.tar.xz",
            "upload_url": "${{ github.event_name == \"release\" && github.event.release.upload_url || github.inputs.release_upload_url }}"
          }
        }
      ]
    }
  },
  "name": "Release",
  "on": {
    "release": {
      "types": [
        "created"
      ]
    },
    "workflow_dispatch": {
      "inputs": {
        "release_upload_url": {
          "description": "The `upload_url` of the release to target"
        }
      }
    }
  }
}
